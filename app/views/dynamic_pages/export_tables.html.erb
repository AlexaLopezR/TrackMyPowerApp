<% provide(:page_title, @page.title) %>
<% provide(:title, @page.title) %>

<% content_for :tables do %>
  <!--Time Interval Calendar -->
  <label class="no-margin col-md-1 col-sm-1 col-xs-12">Time Interval </label>
  <div class="no-margin col-md-4 col-sm-4 col-xs-12">
    <div id="calendar" class="pull-left" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
      <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
      <span style="font-weight: normal;">December 30, 2014 - January 28, 2015</span> <b class="caret"></b>
    </div>
    <!--<input type="text" class="daterange"/>-->
  </div>
  <!--Group Buttons -->
  <label class="no-margin col-md-1 col-sm-1 col-xs-12">Group </label>
  <div class="col-md-6 col-sm-6 col-xs-12">
    <div id="selector" class="btn-group" data-toggle="buttons">
      <%= render 'buttons' %>
    </div>
  </div>
  <!--Blank line -->
  <div class="col-md-12 col-sm-12 col-xs-12">
    </br>
  </div>
  <!--Checkboxes -->
  <div id="checkbox_list">
    <%= render partial: '/ajax_calls/checkbox_list', locals: { variables: @electrical_variables } %>
  </div>
  <!--Blank line -->
  <div class="col-md-12 col-sm-12 col-xs-12"></div>
  <!--Select All Button -->
  <div class="row">
    <div class="col-md-6 col-xs-6">
      </br>
    </div>
    <div class="col-md-6 col-xs-6">
      <div class="text-right">
        <label>
          <button id="sel-all-btn" value="Select All" onclick="SelectAll()" type="button" class="btn btn-success">Select All</button>
        </label>
      </div>
    </div>
  </div>
  <!-- Solid line -->
  <div class="col-md-12 col-sm-12 col-xs-12">
    <div class="ln_solid"></div>
  </div>
  <!-- DataTable -->
  <div class="col-md-12 col-sm-12 col-xs-12">
    <div id="refreshTable">
      <table id="datatable" class="table table-striped table-bordered bulk_action" style="opacity:0;">
      </table>
    </div>
  </div>
<% end %>

<% content_for :page_scripts do %>
<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
<%= javascript_include_tag("manage_button") %>
<script>
  function reloadCheckboxes() {
    if ($("input.flat")[0]) {
        $(document).ready(function () {
            $('input.flat').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            });
        });
    }
  }
</script>
<script>
  function initCalendar() {
    var cb = function(start, end, label) {
      $('#calendar span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
    };

    var optionSet1 = {
      startDate: moment().subtract(1, 'month'),
      endDate: moment(),
      minDate: '07/01/2016',

      dateLimit: {
        days: 365
      },
      showDropdowns: true,
      showWeekNumbers: true,
      timePicker: true,
      timePickerIncrement: 10,
      timePicker12Hour: false,
      ranges: {
        'Today': [moment(), moment()],
        'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
        'Last 7 Days': [moment().subtract(7, 'days'), moment()],
        'Last 30 Days': [moment().subtract(1, 'month'), moment()],
        'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
      },
      opens: 'right',
      format: 'MM/DD/YYYY',
      separator: ' to ',
      locale: {
        applyLabel: 'Set',
        cancelLabel: 'Clear',
        customRangeLabel: 'Custom',
        daysOfWeek: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
        monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
        firstDay: 1
      }
    };

    //default calendar date
    $('#calendar span').html(moment().subtract(1, 'month').format('MMMM D, YYYY') + ' - ' + moment().format('MMMM D, YYYY'));
    //calendar settings
    $('#calendar').daterangepicker(optionSet1, cb);
  }
</script>

<script>
  $(document).ready(function() {
    var refresh_checkboxes = function (data) {
      result = data;
      document.getElementById('checkbox_list').innerHTML = result;
      document.getElementById("sel-all-btn").classList.remove('btn-danger');
      document.getElementById("sel-all-btn").classList.add('btn-success');
      document.getElementById("sel-all-btn").childNodes[0].nodeValue = "Select All";
      reloadCheckboxes();
    }
    initCalendar();
    //event: apply/hide --> Calendar
    $('#calendar').on('hide.daterangepicker', function(ev, picker) {
      picker_obj = picker;
    });
    //event: click --> Checkbuttons
    $('#selector label').click(function() {
      $(this).addClass('active').siblings().removeClass('active');
      ajax_call('html', this.id, '<%= refresh_checkboxes_tables_path %>', refresh_checkboxes, false);
    });
  });
</script>
<% end %>
<%= render @page %>
